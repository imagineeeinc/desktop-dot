source=~/.config/hypr/mocha.conf
$SCRIPTS = ~/.config/hypr/scripts

# MONITORS - https://wiki.hyprland.org/Configuring/Monitors/
# Native
monitor=eDP-1,preferred,0x0,1.0666667, bitdepth, 16, cm, auto
monitor=HDMI-A-1,1920x1080@100.00,0x-1080,1, bitdepth, 10, cm, auto
monitor=DP-1,1920x1080@100.00,0x-1080,1, bitdepth, 10, cm, auto
monitor=DP-2,1920x1080@100.00,0x-1080,1, bitdepth, 10, cm, auto
# Standard (for recording)
# monitor=,1920x1080,auto,1

# PROGRAMS - https://wiki.hyprland.org/Configuring/Keywords/
$terminal = kitty
$fileManager = dolphin
$menu = tofi-drun
$runner = wofi --show run
$browser_class = Vivaldi-flatpak

# AUTOSTART
# exec-once = hyprnotify --font-size 16

exec-once = waybar & awww-daemon & hypridle & dunst & waycorner
exec-once = nwg-dock-hyprland -i 35 -nolauncher -hd 1000 -mb 20 -d
exec-once = /usr/libexec/pam_kwallet_init
exec-once = systemctl --user start hyprpolkitagent
exec-once = fcitx5
exec-once = udiskie

exec-once = blueman-applet & nm-applet
exec-once = wl-paste --type text --watch cliphist store # Stores only text data
exec-once = wl-paste --type image --watch cliphist store # Stores only image data
exec-once = hyprctl setcursor BreezeX-RoséPine 38
exec-once = logid
exec-once = /usr/bin/python ~/.config/hypr/fabric/widgets.py > ~/log

# ENV - https://wiki.hyprland.org/Configuring/Environment-variables/
# env = XCURSOR_SIZE,38
env = HYPRCURSOR_SIZE,38
env = HYPRSHOT_DIR, /home/imagineee/Pictures/Screenshots
env = XDG_SESSION_DESKTOP, Hyprland
env = QT_QPA_PLATFORM, wayland
env = QT_QPA_PLATFORMTHEME, qt6ct
env = XCURSOR_THEME, BreezeX-RoséPine
env = XDG_DESKTOP_PORTAL, 1
env = TERM, kitty
# env = HYPRCURSOR_THEME, BreezeX-RoséPine
# env = HYPRCURSOR_SIZE, 38
env = QT_IM_MODULE, fcitx
env = XMODIFIERS, @im=fcitx
# env = SSH_AUTH_SOCK,$XDG_RUNTIME_DIR/ssh-agent.socket
env = SSH_ASKPASS,/usr/bin/ksshaskpass
env = SSH_ASKPASS_REQUIRE,prefer

# GENERAL CONFIG - https://wiki.hyprland.org/Configuring/Variables/#general
general {
    gaps_in = 5
    gaps_out = 15

    border_size = 3

    col.active_border = $blue $sapphire $sky $teal 45deg
    col.inactive_border = $surface2

    resize_on_border = true

    allow_tearing = false

    layout = dwindle
}

# DECORATIONS - https://wiki.hyprland.org/Configuring/Variables/#decoration
decoration {
    rounding = 10

    active_opacity = 1.0
    inactive_opacity = 1.0

    shadow {
        enabled = true
        range = 5
        render_power = 3
        color = $crust
    }

    # https://wiki.hyprland.org/Configuring/Variables/#blur
    blur {
        enabled = true
        size = 3
        passes = 2

        noise = 0.03
        vibrancy = 0.1696
        vibrancy_darkness = 0

        input_methods = true
    }
}

# ANIMATIONS - https://wiki.hyprland.org/Configuring/Variables/#animations
animations {
    enabled = yes

    # Configuring, see https://wiki.hyprland.org/Configuring/Animations/

    bezier = easeOutQuint,0.23,1,0.32,1
    bezier = easeInOutCubic,0.65,0.05,0.36,1
    bezier = linear,0,0,1,1
    bezier = almostLinear,0.5,0.5,0.75,1.0
    bezier = quick,0.15,0,0.1,1

    animation = global, 1, 10, default
    animation = border, 1, 5.39, easeOutQuint
    animation = windows, 1, 4.79, easeOutQuint,
    animation = windowsIn, 1, 1.8, easeOutQuint, popin 87%
    animation = windowsOut, 1, 1.49, linear, popin 87%
    animation = windowsMove, 1, 4, easeOutQuint
    animation = fadeIn, 1, 1.73, almostLinear
    animation = fadeOut, 1, 1.46, almostLinear
    animation = fade, 1, 3.03, quick
    animation = layers, 1, 3.81, easeOutQuint
    animation = layersIn, 1, 2, easeOutQuint, popin
    animation = layersOut, 1, 1.5, linear, fade
    animation = fadeLayersIn, 1, 1.79, almostLinear
    animation = fadeLayersOut, 1, 1.39, almostLinear
    animation = workspaces, 1, 1, easeInOutCubic, slide
    animation = workspacesIn, 1, 1.21, easeInOutCubic, slide
    animation = workspacesOut, 1, 1.94, easeInOutCubic, slide
    animation = specialWorkspace, 1, 1.94, almostLinear, fade
    animation = monitorAdded, 1, 1.5, easeOutQuint
    animation = fadeDpms, 1, 1.5, easeOutQuint
}

# WORKSPACE RULES - https://wiki.hyprland.org/Configuring/Workspace-Rules/
# workspace = w[tv1], gapsout:0, gapsin:0

# DWINDLE - https://wiki.hyprland.org/Configuring/Dwindle-Layout/
dwindle {
  pseudotile = true
  preserve_split = true
  precise_mouse_move = true
}

# MASTER - https://wiki.hyprland.org/Configuring/Master-Layout/
master {
    new_status = master
}

# MISC - https://wiki.hyprland.org/Configuring/Variables/#misc
misc {
    force_default_wallpaper = 1 # Set to 0 or 1 to disable the anime mascot wallpapers
    disable_hyprland_logo = true
    font_family = SpaceMono Nerd Font
    middle_click_paste = false
    mouse_move_enables_dpms = false
    key_press_enables_dpms = true
}

# BINDS - https://wiki.hyprland.org/Configuring/Variables/#binds
binds {
    workspace_back_and_forth = true
    hide_special_on_workspace_change = true
    drag_threshold = 30
}

# INPUT - https://wiki.hyprland.org/Configuring/Variables/#input
input {
    kb_layout = gb
    kb_variant =
    kb_model =
    kb_options =
    kb_rules =
    numlock_by_default = true

    follow_mouse = 1
    sensitivity = 0.1 # -1.0 - 1.0, 0 means no modification.
    special_fallthrough = true
    emulate_discrete_scroll = 2
    scroll_factor = 1

    touchpad {
        natural_scroll = true
        scroll_factor = 0.7
        # drag_3fg = true
    }
}

# TRACKPAD GESTURES - https://wiki.hyprland.org/Configuring/Variables/#gestures
gestures {
    # workspace_swipe = true
    # workspace_swipe_fingers = 4
    workspace_swipe_distance = 200
    workspace_swipe_cancel_ratio = 0.2
    workspace_swipe_forever = true
}
gesture = 4, horizontal, workspace
# gesture = 4, up, dispatcher, hyprexpo:expo, enable
# gesture = 4, down, dispatcher, hyprexpo:expo, disable
gesture = 3, pinch, mod: SUPER, float
gesture = 4, swipe, mod: SUPER, move
gesture = 3, swipe, mod: SUPER, resize
# gesture = 3, left, dispatcher, sendshortcut, CTRL SHIFT, tab, class:^($browser_class)$
# gesture = 3, right, dispatcher, sendshortcut, CTRL, tab, class:^($browser_class)$
gesture = 3, left, dispatcher, layoutmsg, move -col
gesture = 3, right, dispatcher, layoutmsg, move +col

# PER DEVICE CONFIG - https://wiki.hyprland.org/Configuring/Keywords/#per-device-input-configs
device {
    name = logitech-wireless-mouse-mx-master-2s-1
    sensitivity = -0.8 # Compansate for 2000 dpi
}

# GROUP - https://wiki.hypr.land/Configuring/Variables/#group
group {
    drag_into_group = 2
    merge_floated_into_tiled_on_groupbar = true

    col.border_active = $sapphire
    col.border_inactive = $surface2
    col.border_locked_active = $peach
    col.border_locked_inactive = $peach

    groupbar {
        enabled = true
        font_size = 16
        font_weight_active = bold
        height = 24
        gradients = true
        indicator_height = 0
        indicator_gap = 0

        gradient_rounding = 10
        text_offset = 2
        text_color = $text
        text_color_inactive = $subtext0
        col.active = $surface0
        col.inactive = $base
        col.locked_active = $surface0
        col.locked_inactive = $base
        keep_upper_gap = false
      }
}

# KEYBINDS - https://wiki.hyprland.org/Configuring/Keywords/
$mainMod = SUPER

# Main
bindd = $mainMod, code:49, Open terminal, exec, $terminal
bindd = $mainMod CTRL, code:49, Open terminal, exec, [float] $terminal
bindd = $mainMod, W, Close current window, killactive,
bindd  = $mainMod CTRL, W, Close current window, killactive,
bindd = $mainMod SHIFT, W, Kill current window, forcekillactive,
bindld = $mainMod CTRL SHIFT ALT, M, Exit Hyprland (back to sddm), exec, uwsm stop
bindd = $mainMod, M, Open System Menu, exec, python -m fabric execute Widgets "toggle_system_menu()" -j
bindd = $mainMod, E, Open file manager, exec, $fileManager
bindd = $mainMod, Q, Toggle floating window, togglefloating,
bindd = $mainMod, space, Open apps menu, exec, $menu
bindd = $mainMod, R, Open ocmmand runner, exec, $runner
bindd = $mainMod, H, Dwindle window, pseudo, # dwindle
bindd = $mainMod, J, Toggle splitting direction, togglesplit, # dwindle
bindd = $mainMod SHIFT, N, Open notification panel, exec, swaync-client -t -sw
bindd = CTRL ALT, delete, Open power panel, exec, wlogout
# bind = $mainMod, g, hyprexpo:expo, enable
# bind = $mainMod, g, submap, expo
bindd = ALT, space, Toggle dock, exec, nwg-dock-hyprland

submap=expo
  
  bindd = , 1, Switch to workspace 1, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 1
  bindd = , 2, Switch to workspace 2, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 2
  bindd = , 3, Switch to workspace 3, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 3
  bindd = , 4, Switch to workspace 4, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 4
  bindd = , 5, Switch to workspace 5, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 5
  bindd = , 6, Switch to workspace 6, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 6
  bindd = , 7, Switch to workspace 7, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 7
  bindd = , 8, Switch to workspace 8, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 8
  bindd = , 9, Switch to workspace 9, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 9
  bindd = , 0, Switch to workspace 10, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace 10

  bindd = , code:48, Switch to next empty workspace, exec, hyprctl dispatch submap reset; hyprctl dispatch workspace emptynm

  # bind = SUPER, g, hyprexpo:expo, disable
  bind = SUPER, g, submap, reset
  # bind= , escape , hyprexpo:expo, disable
  bind= , escape , submap, reset

submap=reset

# Fullscreen mode and other screen settings
bindd = $mainMod SHIFT, F, Fullscreen app and hide waybar toggle, exec, (killall  waybar && hyprctl --batch "keyword general:gaps_out 0") || (hyprctl --batch "keyword general:gaps_out 15" && waybar) # -SIGUSR1
bindd = $mainMod, O, Swtich display size, exec, python -m fabric execute Widgets "monitor_resolution.show()" -j # ~/.config/hypr/resolution_selector.sh
bindd = $mainMod, I, Swtich wallpaper, exec, ~/.config/hypr/wofi_wallpaper_selector.sh
bindd = $mainMod, P, Projection mode selector, exec, python -m fabric execute Widgets "monitor_settings.show()" -j # ~/.config/hypr/display_mode.sh
bindd = $mainMod SHIFT ALT, B, Set main display to active, exec, hyprctl --batch "keyword monitor eDP-1,preferred,0x0,1.0666667"

# Clipboard
bindd = $mainMod, V, Clipboard history, exec, cliphist list | wofi --dmenu | cliphist decode | wl-copy
bindd = $mainMod, code:59, Emoji picker, exec, flatpak run com.tomjwatson.Emote
bindd = $mainMod SHIFT, I, Colour picker, exec, hyprpicker | wl-copy

# Screenshot
bindd = , PRINT, Take a fullscreen screenshot, exec, hyprshot -m output -z
bindd = SHIFT, PRINT, Take a screenshot of a window, exec, hyprshot -m window -z
bindd = $mainMod SHIFT, S, Take a screenshot of a region, exec, hyprshot -m region -z
bindd = $mainMod CTRl SHIFT, S, Take a screenshot of a region (clipboard only), exec, hyprshot -m region -z --clipboard-only

# Lock
bindd = $mainMod, L, Lock screen, exec, hyprlock
bindld = $mainMod CTRL SHIFT, L, Lock and sleep, exec, loginctl lock-session && systemctl suspend

# Browser
bindd = MOD5, page_up, Send alt+left to vivaldi (history back),sendshortcut, ALT, left, class:^($browser_class)$
bindd = MOD5, left, Send alt+right to vivaldi (history forward), sendshortcut, ALT, right, class:^($browser_class)$
bindd = ALT, mouse:276, Send ctrl+tab to vivaldi (forward tab),sendshortcut, CTRL, tab, class:^($browser_class)$
bindd = ALT, mouse:275, Send ctrl+shift+tab to vivaldi (previous tab), sendshortcut, CTRL SHIFT, tab, class:^($browser_class)$

# Minecraft
bind = , mouse_left, sendkeystate, , page_up, down, class:mcpelauncher-client
bind = , mouse_right, sendshortcut, , page_down, class:mcpelauncher-client

# Music
bindild = , code:201, Toggle play/ pause of music, exec, playerctl play-pause
bindd = $mainMod, N, Open mpd client, exec, kitty --class=rmpc rmpc
bindd = $mainMod SHIFT, N, Enable/ Disable mpris for mpd, exec, (systemctl status --user mpd-mpris | grep inactive && systemctl start --user mpd-mpris) || (systemctl stop --user mpd-mpris)

# Move focus
bindd = $mainMod, left, Focus left window, movefocus, l
bindd = $mainMod, right, Focus right window,movefocus, r
bindd = $mainMod, up, Focus up window,movefocus, u
bindd = $mainMod, down, Focus down window,movefocus, d

# Mouse shortcuts
bindmd = $mainMod, mouse:272, Move window, movewindow
bindmd = $mainMod, Control_L, Move window, movewindow
bindmd = $mainMod, mouse:273, Resize window, resizewindow
bindmd = $mainMod, ALT_L, Resize window, resizewindow

# Switch workspaces
bindd = $mainMod, 1, Switch to workspace 1, workspace, 1
bindd = $mainMod, 2, Switch to workspace 2, workspace, 2
bindd = $mainMod, 3, Switch to workspace 3, workspace, 3
bindd = $mainMod, 4, Switch to workspace 4, workspace, 4
bindd = $mainMod, 5, Switch to workspace 5, workspace, 5
bindd = $mainMod, 6, Switch to workspace 6, workspace, 6
bindd = $mainMod, 7, Switch to workspace 7, workspace, 7
bindd = $mainMod, 8, Switch to workspace 8, workspace, 8
bindd = $mainMod, 9, Switch to workspace 9, workspace, 9
bindd = $mainMod, 0, Switch to workspace 10, workspace, 10
bindd = $mainMod, tab, Go forward a workspace, workspace, +1
bindd = $mainMod SHIFT, tab, Go back a workspace, workspace, -1
bindd = ALT, tab, Go to previous workspace, workspace, previous
bindd = $mainMod, mouse:276, Go forward a workspace, workspace, r+1
bindd = $mainMod, mouse:275, Go back a workspace, workspace, r-1

bindd = $mainMod, code:80, Move window to HDMI 1,movewindow, mon:HDMI-A-1
bindd = $mainMod, code:88, Move window to Main Display,movewindow, mon:eDP-1

# Move active window to a workspace
bindd = $mainMod SHIFT, 1, Move window to workspace 1, movetoworkspace, 1
bindd = $mainMod SHIFT, 2, Move window to workspace 2, movetoworkspace, 2
bindd = $mainMod SHIFT, 3, Move window to workspace 3, movetoworkspace, 3
bindd = $mainMod SHIFT, 4, Move window to workspace 4, movetoworkspace, 4
bindd = $mainMod SHIFT, 5, Move window to workspace 5, movetoworkspace, 5
bindd = $mainMod SHIFT, 6, Move window to workspace 6, movetoworkspace, 6
bindd = $mainMod SHIFT, 7, Move window to workspace 7, movetoworkspace, 7
bindd = $mainMod SHIFT, 8, Move window to workspace 8, movetoworkspace, 8
bindd = $mainMod SHIFT, 9, Move window to workspace 9, movetoworkspace, 9
bindd = $mainMod SHIFT, 0, Move window to workspace 10, movetoworkspace, 10

# scratchpad, window
bind = $mainMod, D, togglespecialworkspace, magic
bind = $mainMod SHIFT, D, movetoworkspace, special:magic
bindd = $mainMod SHIFT, P, Pin window, pin, active

# group windows
bindd = $mainMod, T, Group Window, togglegroup
bindd = $mainMod ALT, right, Next group tab, changegroupactive

# Switch to window in group
bindd = $mainMod CTRL, 1, Switch to window 1, changegroupactive, 1
bindd = $mainMod CTRL, 2, Switch to window 2, changegroupactive, 2
bindd = $mainMod CTRL, 3, Switch to window 3, changegroupactive, 3
bindd = $mainMod CTRL, 4, Switch to window 4, changegroupactive, 4
bindd = $mainMod CTRL, 5, Switch to window 5, changegroupactive, 5
bindd = $mainMod CTRL, 6, Switch to window 6, changegroupactive, 6
bindd = $mainMod CTRL, 7, Switch to window 7, changegroupactive, 7
bindd = $mainMod CTRL, 8, Switch to window 8, changegroupactive, 8
bindd = $mainMod CTRL, 9, Switch to window 9, changegroupactive, 9
bindd = $mainMod CTRL, 0, Switch to window 10, changegroupactive, 10

# Scroll through existing workspaces
bind = $mainMod, mouse_right, workspace, +1
bind = $mainMod, mouse_left, workspace, -1

# Used in conjuntion with mouse gestures
bind = $mainMod CTRL, tab, workspace, r+1
bind = $mainMod CTRL SHIFT, tab, workspace, r-1

# Laptop multimedia keys for volume and LCD brightness
bindel = ,XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bindel = ,XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindel = ,XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindel = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = ,XF86MonBrightnessUp, exec, brightnessctl s 10%+
bindel = ,XF86MonBrightnessDown, exec, brightnessctl s 10%-

bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPrev, exec, playerctl previous

bindd = $mainMod, slash, toggle the fit of a window,layoutmsg, togglefit

bind = $mainMod, S, togglespecialworkspace, minimize
bind = $mainMod, S, movetoworkspace, +0
bind = $mainMod, S, togglespecialworkspace, minimize
bind = $mainMod, S, movetoworkspace, special:minimize
bind = $mainMod, S, togglespecialworkspace, minimize

# WINDOW RULES - See https://wiki.hyprland.org/Configuring/Window-Rules/
# WORKSPACE RULES - https://wiki.hyprland.org/Configuring/Workspace-Rules/
# Ignore maximize requests from apps
windowrulev2 = suppressevent maximize, class:.*
# Fix some dragging issues with XWayland
windowrulev2 = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0
windowrule = scrollmouse 0.033, class:mcpelauncher-client
windowrule = keepaspectratio on, class:^(scrcpy)$
windowrule = noborder 1, class:^(scrcpy)$
windowrule = noshadow 1, class:^(scrcpy)$
windowrule = xray, class:^(kitty)$
windowrule = noborder 1, class:^(kitty)$ floating:1
windowrule = noshadow 1, class:^(kitty)$ floating:1
windowrule = move 100%-w-20 100%-w-20, title:^(Copying — Dolphin)$
windowrule = noborder 1, class:^(wofi)$
windowrule = noshadow 1, class:^(wofi)$
windowrule = float, initialTitle:^(Bitwarden - Vivaldi)$
windowrule = size 500 700, initialTitle:^(Bitwarden - Vivaldi)$
windowrule = move 100%-500 40, initialTitle:^(Bitwarden - Vivaldi)$
windowrule = xray, class:^(rmpc)$
windowrule = float, class:^(rmpc)$
windowrule = noborder 1, class:^(rmpc)$
windowrule = noshadow 1, class:^(rmpc)$
# https://amealky.itch.io/teddy-desktop-pet
windowrule = noborder 1, class:^(Teddy)$
windowrule = noshadow 1, class:^(Teddy)$
windowrule = noblur 1, class:^(Teddy)$

# Custom control panels
$panels = org.pulseaudio.pavucontrol|blueman-manager
windowrule = float, class:^($panels)$
windowrule = noborder 1, class:^($panels)$
windowrulev2 = move 100%-w-15 63, class:^($panels)$
windowrulev2 = size 500 500, class:^($panels)$

windowrule = opacity 0.0 override, class:^(xwaylandvideobridge)$
windowrule = noanim, class:^(xwaylandvideobridge)$
windowrule = noinitialfocus, class:^(xwaylandvideobridge)$
windowrule = maxsize 1 1, class:^(xwaylandvideobridge)$
windowrule = noblur, class:^(xwaylandvideobridge)$
windowrule = nofocus, class:^(xwaylandvideobridge)$

layerrule = blur,waybar
layerrule = ignorealpha,waybar$
layerrule = blur,notifications
layerrule = ignorealpha,notifications$
layerrule = blur,nwg-dock
layerrule = ignorealpha,nwg-dock$
layerrule = blur,wofi
layerrule = ignorealpha,wofi$
layerrule = blur,launcher
layerrule = ignorealpha,launcher$
layerrule = blur,top$
layerrule = ignorealpha,top$
layerrule = blur,logout_dialog
layerrule = blur,resolution-settings$
layerrule = ignorealpha,resolution-settings$
layerrule = blur,brightness-settings$
layerrule = ignorealpha,brightness-settings$
layerrule = blur,monitor-settings$
layerrule = ignorealpha,monitor-settings$
layerrule = blur,system-menu$
layerrule = ignorealpha,system-menu$

xwayland {
  force_zero_scaling = true
}

# PLUGINS - https://hypr.land/plugins/
plugin {
    hyprexpo {
        columns = 3
        gap_size = 15
        bg_col = $base
        workspace_method = center r # [center/first] [workspace] e.g. first 1 or center m+1
        skip_empty = true

        enable_gesture = true # laptop touchpad
        gesture_fingers = 4
        gesture_distance = 300 # how far is the "max"
        gesture_positive = false # positive = swipe down. Negative = swipe up.
    }
    hyprscrolling {
        column_width = 0.5
        fullscreen_on_one_column = true
        focus_fit_method = 1
        follow_focus = true
    }
}
